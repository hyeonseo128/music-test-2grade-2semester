<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŒì•… ìˆ˜í–‰í‰ê°€ í”„ë¡œê·¸ë¨</title>
    <base href="/music-test-2grade-2semester/"> 
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 700px;
            width: 100%;
            text-align: center;
        }
        
        .header {
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .mode-selector {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }
        
        .mode-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .mode-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            border-radius: 25px;
            background: white;
            color: #667eea;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        .mode-btn.active {
            background: #667eea;
            color: white;
        }
        
        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .question-info {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }
        
        .question-number {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .audio-container {
            background: #fff;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }
        
        .music-icon {
            font-size: 4em;
            color: #667eea;
            margin-bottom: 20px;
        }
        
        audio {
            width: 100%;
            margin-bottom: 20px;
            border-radius: 10px;
        }
        
        .answer-section {
            margin-bottom: 30px;
        }
        
        .answer-title {
            background: #e8f2ff;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            border: 2px dashed #667eea;
            margin-bottom: 15px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }
        
        .answer-title.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .knowledge-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .know-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }
        
        .know-yes {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        
        .know-no {
            background: linear-gradient(45deg, #dc3545, #fd7e14);
            color: white;
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }
        
        .know-btn:hover {
            transform: translateY(-2px);
        }
        
        .know-yes:hover {
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }
        
        .know-no:hover {
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.4);
        }
        
        .control-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        button {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
        }
        
        .show-answer-btn {
            background: linear-gradient(45deg, #6f42c1, #e83e8c);
            color: white;
            box-shadow: 0 5px 15px rgba(111, 66, 193, 0.3);
        }
        
        .show-answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(111, 66, 193, 0.4);
        }
        
        .next-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .reset-btn {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }
        
        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .stats {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #28a745;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 3px solid #667eea;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        
        .no-questions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #856404;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .mode-buttons,
            .knowledge-buttons,
            .control-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            button,
            .mode-btn,
            .know-btn {
                width: 200px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸµ ìŒì•… ìˆ˜í–‰í‰ê°€</h1>
            <p>ìŒì•…ì„ ë“£ê³  ì œëª©ì„ ë§ì¶°ë³´ì„¸ìš”!</p>
        </div>
        
        <div class="mode-selector">
            <div class="mode-title">ğŸ“š í•™ìŠµ ëª¨ë“œ ì„ íƒ</div>
            <div class="mode-buttons">
                <button class="mode-btn active" data-mode="all">ì „ì²´ ë¬¸ì œ</button>
                <button class="mode-btn" data-mode="known">ì•„ëŠ” ë¬¸ì œë§Œ</button>
                <button class="mode-btn" data-mode="unknown">ëª¨ë¥´ëŠ” ë¬¸ì œë§Œ</button>
            </div>
        </div>
        
        <div id="gameArea">
            <div class="question-info">
                <div class="question-number">
                    <span id="modeDisplay">ì „ì²´ ë¬¸ì œ</span> - ë¬¸ì œ <span id="currentQuestion">1</span> / <span id="totalQuestions">20</span>
                </div>
                <div>ì•„ë˜ ìŒì•…ì„ ë“£ê³  ì œëª©ì„ ìƒê°í•´ë³´ì„¸ìš”</div>
            </div>
            
            <div class="audio-container">
                <div class="music-icon">ğŸ¼</div>
                <audio id="audioPlayer" controls>
                    <source id="audioSource" src="" type="audio/mpeg">
                    ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </audio>
            </div>
            
            <div class="knowledge-buttons">
                <button id="knowYesBtn" class="know-btn know-yes">
                    âœ… ì•Œì•„ìš”
                </button>
                <button id="knowNoBtn" class="know-btn know-no">
                    âŒ ëª°ë¼ìš”
                </button>
            </div>
            
            <div class="answer-section">
                <div id="answerTitle" class="answer-title">
                    ì •ë‹µ: <span id="currentTitle">ì •ë‹µë³´ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</span>
                </div>
            </div>
            
            <div class="control-buttons">
                <button id="showAnswerBtn" class="show-answer-btn">
                    ğŸ“ ì •ë‹µë³´ê¸°
                </button>
                <button id="nextBtn" class="next-btn" disabled>
                    â¡ï¸ ë‹¤ìŒë¬¸ì œ
                </button>
                <button id="resetBtn" class="reset-btn">
                    ğŸ”„ ì²˜ìŒë¶€í„°
                </button>
            </div>
        </div>
        
        <div id="noQuestionsMessage" class="no-questions" style="display: none;">
            <h3>ğŸ˜Š í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!</h3>
            <p>ë‹¤ë¥¸ ëª¨ë“œë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì „ì²´ ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”.</p>
        </div>
        
        <div class="stats">
            <div class="stats-title">ğŸ“Š í•™ìŠµ í†µê³„</div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-label">ì´ ë¬¸ì œ</div>
                    <div class="stat-value" id="totalStat">20</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">ì•„ëŠ” ë¬¸ì œ</div>
                    <div class="stat-value" id="knownStat">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">ëª¨ë¥´ëŠ” ë¬¸ì œ</div>
                    <div class="stat-value" id="unknownStat">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">ë‚¨ì€ ë¬¸ì œ</div>
                    <div class="stat-value" id="remainingStat">20</div>
                </div>
            </div>
        </div>
    </div>

<script>
        // DOMContentLoaded ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOMContentLoaded event fired. Script is running."); // ì´ ë¡œê·¸ê°€ ì°íˆëŠ”ì§€ í™•ì¸

            // 20ê°œì˜ ìƒ˜í”Œ ìŒì•… ë°ì´í„°
            const musicList = [
                { title: "ì¤‘ì„¸ì‹œëŒ€ - ì„±ìš”í•œ ì°¬ê°€", file: "1.mp3", id: 0 },
                { title: "ë¥´ë„¤ìƒìŠ¤ ì‹œëŒ€ - ì•„ë² ë§ˆë¦¬ì•„", file: "2.mp3", id: 1 },
                { title: "ë°”í - í† ì¹´íƒ€ì™€ í‘¸ê°€ ë¼ë‹¨ì¡°", file: "3.mp3", id: 2 },
                { title: "í—¨ë¸ - ì˜¤ë¼í† ë¦¬ì˜¤ 'ë©”ì‹œì•„' ì¤‘ 'í• ë ë£¨ì•¼'", file: "4.mp3", id: 3 },
                { title: "ë¹„ë°œë”” - ì‚¬ê³„ ì¤‘ ë´„ 1ì•…ì¥", file: "5.mp3", id: 4 },
                { title: "í•˜ì´ë“  - íŠ¸ëŸ¼í« í˜‘ì£¼ê³¡ 3ì•…ì¥", file: "6.mp3", id: 5 },
                { title: "ë² í† ë²¤ - ì›”ê´‘ì†Œë‚˜íƒ€ 1ì•…ì¥", file: "7.mp3", id: 6 },
                { title: "ë² í† ë²¤ - ë¹„ì°½ì†Œë‚˜íƒ€ 3ì•…ì¥", file: "8.mp3", id: Â 7 },
                { title: "ë² í† ë²¤ - êµí–¥ê³¡ 5ë²ˆ ìš´ëª…", file: "9.mp3", id: 8 },
                { title: "ëª¨ì°¨ë¥´íŠ¸ - ì˜¤í˜ë¼ 'ë§ˆìˆ í”¼ë¦¬' ì¤‘ 'ë°¤ì˜ ì—¬ì™•ì˜ ì•„ë¦¬ì•„'", file: "10.mp3", id: 9 },
                { title: "ëª¨ì°¨ë¥´íŠ¸ - ì˜¤í˜ë¼ 'í”¼ê°€ë¡œì˜ ê²°í˜¼' ì¤‘ 'ë” ì´ìƒ ë‚ ì§€ ëª»í•˜ë¦¬ ë‚˜ë¹„ì•¼'", file: "11.mp3", id: 10 },
                { title: "ëª¨ì°¨ë¥´íŠ¸ - ë ˆí€´ì—  ì¤‘ ë¼í¬ë¦¬ëª¨ì‚¬", file: "12.mp3", id: 11 },
                { title: "ë¼ë²¨ - ë³¼ë ˆë¡œ", file: "13.mp3", id: 12 },
                { title: "ë“œë·”ì‹œ - ë‹¬ë¹›", file: "14.mp3", id: 13 },
                { title: "ë¡œì‹œë‹ˆ - ì˜¤í˜ë¼ 'ì„¸ë¹„ì•¼ì˜ ì´ë°œì‚¬' ì¤‘ 'ë‚˜ëŠ” ê±°ë¦¬ì˜ ë§Œë¬¼ë°•ì‚¬'", file: "15.mp3", id: 14 },
                { title: "í•˜ì§€ì˜ - ì—¬í–‰ì„ ë– ë‚˜ìš”", file: "16.mp3", id: 15 },
                { title: "ìŠˆë² ë¥´íŠ¸ - ë§ˆì™•", file: "17.mp3", id: 16 },
                { title: "í‚¤ë¬´ë¼ ìœ ë¯¸ - ì–¸ì œë‚˜ ëª‡ ë²ˆì´ë¼ë„", file: "18.mp3", id: 17 },
                { title: "ì‡¼íŒ½ - ì—íŠ€ë“œ í‘ê±´ op.10 no.5", file: "19.mp3", id: 18 },
                { title: "ì‡¼íŒ½ - ì™ˆì¸  7ë²ˆ op.64 no.2", file: "20.mp3", id: 19 },
                { title: "ì‡¼íŒ½ â€“ ì—íŠ€ë“œ op.25 no.11 â€˜ê²¨ìš¸ë°”ëŒâ€™", file: "21.mp3", id: 19 }, 
                { title: "ë¦¬ìŠ¤íŠ¸ â€“ ëŒ€ì—°ìŠµê³¡ S.141. no.3 â€˜ë¼ìº„íŒŒë„¬ë¼â€™", file: "22.mp3", id: 19 },
                { title: "ìŠˆíŠ¸ë¼ìš°ìŠ¤ - ì°¨ë¼íˆ¬ìŠ¤íŠ¸ë¼ëŠ” ì´ë ‡ê²Œ ë§í–ˆë‹¤.", file: "23.mp3", id: 19 },
                { title: "ì‡¤ë² ë¥´í¬ â€“ ë‹¬ì— í™€ë¦° í”¼ì—ë¡œ 8ë²ˆ ë°¤", file: "24.mp3", id: 19 },
                { title: "ìŠˆí†¡í•˜ìš°ì   - ìŠµì‘2", file: "25.mp3", id: 19 },
                { title: "ì¡´ ì¼€ì´ì§€ â€“ 4:33"}
            ];

            // ê²Œì„ ìƒíƒœ
            let currentMode = 'all';
            let currentQuestionNumber = 1;
            let currentMusic = null;
            let answerRevealed = false;
            let usedQuestions = [];
            
            // ì§€ì‹ ìƒíƒœ ì €ì¥ (localStorage ëŒ€ì‹  ë©”ëª¨ë¦¬ ì‚¬ìš©)
            let knowledgeState = {};

            // DOM ìš”ì†Œë“¤
            const modeButtons = document.querySelectorAll('.mode-btn');
            const gameArea = document.getElementById('gameArea');
            const noQuestionsMessage = document.getElementById('noQuestionsMessage');
            const audioPlayer = document.getElementById('audioPlayer');
            const audioSource = document.getElementById('audioSource');
            const modeDisplay = document.getElementById('modeDisplay');
            const currentQuestionSpan = document.getElementById('currentQuestion');
            const totalQuestionsSpan = document.getElementById('totalQuestions');
            const currentTitleSpan = document.getElementById('currentTitle');
            const answerTitle = document.getElementById('answerTitle');
            const knowYesBtn = document.getElementById('knowYesBtn');
            const knowNoBtn = document.getElementById('knowNoBtn');
            const showAnswerBtn = document.getElementById('showAnswerBtn');
            const nextBtn = document.getElementById('nextBtn');
            const resetBtn = document.getElementById('resetBtn');

            // í†µê³„ ìš”ì†Œë“¤
            const totalStat = document.getElementById('totalStat');
            const knownStat = document.getElementById('knownStat');
            const unknownStat = document.getElementById('unknownStat');
            const remainingStat = document.getElementById('remainingStat');

            // ëª¨ë“œ ì„ íƒ
            function selectMode(mode) {
                currentMode = mode;
                modeButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.mode === mode) {
                        btn.classList.add('active');
                    }
                });
                
                resetGame();
            }

            // í˜„ì¬ ëª¨ë“œì— ë§ëŠ” ë¬¸ì œ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            function getQuestionsForMode() {
                switch (currentMode) {
                    case 'known':
                        return musicList.filter(music => knowledgeState[music.id] === 'known');
                    case 'unknown':
                        return musicList.filter(music => knowledgeState[music.id] === 'unknown');
                    default:
                        return musicList;
                }
            }

            // ìƒˆ ë¬¸ì œ ë¡œë“œ
            function loadNewQuestion() {
                console.log("loadNewQuestion called"); // ì´ ë¡œê·¸ê°€ ì°íˆëŠ”ì§€ í™•ì¸
                const availableQuestions = getQuestionsForMode();
                
                // í•´ë‹¹ ëª¨ë“œì— ë¬¸ì œê°€ ì—†ëŠ” ê²½ìš°
                if (availableQuestions.length === 0) {
                    showNoQuestionsMessage();
                    return;
                }
                
                const unusedQuestions = availableQuestions.filter(music => !usedQuestions.includes(music.id));
                
                // í•œ ë°”í€´ë¥¼ ë‹¤ ëˆ ê²½ìš°, ë‹¤ì‹œ ì²˜ìŒë¶€í„° ì‹œì‘
                if (unusedQuestions.length === 0) {
                    usedQuestions = []; // ì‚¬ìš©ëœ ë¬¸ì œ ëª©ë¡ ì´ˆê¸°í™”
                    console.log('ğŸ”„ í•œ ë°”í€´ ì™„ë£Œ! ë‹¤ì‹œ ì²˜ìŒë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤.');
                }
                
                // ë‹¤ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ë¬¸ì œë“¤ ê°€ì ¸ì˜¤ê¸°
                const questionsToUse = availableQuestions.filter(music => !usedQuestions.includes(music.id));
                const randomIndex = Math.floor(Math.random() * questionsToUse.length);
                currentMusic = questionsToUse[randomIndex];
                usedQuestions.push(currentMusic.id);

                // ì˜¤ë””ì˜¤ ì†ŒìŠ¤ ì„¤ì •
                console.log("Setting audio src to:", currentMusic.file); // ì´ ë¡œê·¸ê°€ ì°íˆëŠ”ì§€ì™€ ê²½ë¡œê°’ í™•ì¸
                audioSource.src = currentMusic.file;
                
                // UI ì—…ë°ì´íŠ¸
                updateModeDisplay();
                currentTitleSpan.textContent = 'ì •ë‹µë³´ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”';
                answerTitle.classList.remove('show');
                answerRevealed = false;
                
                // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
                knowYesBtn.disabled = false;
                knowNoBtn.disabled = false;
                showAnswerBtn.disabled = false;
                nextBtn.disabled = true;
                
                // ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ë¦¬ë¡œë“œ
                audioPlayer.load(); // ì´ ë¶€ë¶„ì´ ë°˜ë“œì‹œ í˜¸ì¶œë˜ì–´ì•¼ í•¨
                
                updateStats();
            }

            // ëª¨ë“œ í‘œì‹œ ì—…ë°ì´íŠ¸
            function updateModeDisplay() {
                const availableQuestions = getQuestionsForMode();
                const currentRound = Math.floor((usedQuestions.length - 1) / availableQuestions.length) + 1;
                const currentPosition = ((usedQuestions.length - 1) % availableQuestions.length) + 1;
                
                let modeText = '';
                switch (currentMode) {
                    case 'known':
                        modeText = 'ì•„ëŠ” ë¬¸ì œë§Œ';
                        break;
                    case 'unknown':
                        modeText = 'ëª¨ë¥´ëŠ” ë¬¸ì œë§Œ';
                        break;
                    default:
                        modeText = 'ì „ì²´ ë¬¸ì œ';
                }
                
                modeDisplay.textContent = modeText;
                currentQuestionSpan.textContent = currentPosition;
                totalQuestionsSpan.textContent = availableQuestions.length;
                
                // ë¼ìš´ë“œ ì •ë³´ í‘œì‹œ (2ë¼ìš´ë“œë¶€í„°)
                if (currentRound > 1 && availableQuestions.length > 0) {
                    modeDisplay.textContent = `${modeText} (${currentRound}ë¼ìš´ë“œ)`;
                }
            }

            // ë¬¸ì œ ì—†ìŒ ë©”ì‹œì§€ í‘œì‹œ
            function showNoQuestionsMessage() {
                gameArea.style.display = 'none';
                noQuestionsMessage.style.display = 'block';
            }

            // ê²Œì„ ì˜ì—­ í‘œì‹œ
            function showGameArea() {
                gameArea.style.display = 'block';
                noQuestionsMessage.style.display = 'none';
            }

            // ì•Œì•„ìš”/ëª°ë¼ìš” ë²„íŠ¼ ì²˜ë¦¬
            function markKnowledge(isKnown) {
                if (!currentMusic) return;
                
                knowledgeState[currentMusic.id] = isKnown ? 'known' : 'unknown';
                knowYesBtn.disabled = true;
                knowNoBtn.disabled = true;
                
                updateStats();
            }

            // ì •ë‹µ ë³´ê¸°
            function showAnswer() {
                if (!currentMusic) return;
                
                currentTitleSpan.textContent = currentMusic.title;
                answerTitle.classList.add('show');
                answerRevealed = true;
                
                showAnswerBtn.disabled = true;
                nextBtn.disabled = false;
            }

            // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
            function nextQuestion() {
                currentQuestionNumber++;
                loadNewQuestion();
            }

            // ê²Œì„ ë¦¬ì…‹
            function resetGame() {
                currentQuestionNumber = 1;
                usedQuestions = [];
                showGameArea();
                
                const availableQuestions = getQuestionsForMode();
                if (availableQuestions.length === 0) {
                    showNoQuestionsMessage();
                } else {
                    loadNewQuestion();
                }
            }

            // ì „ì²´ ë¦¬ì…‹
            function fullReset() {
                if (confirm('ëª¨ë“  ì§„í–‰ ìƒí™©ê³¼ í•™ìŠµ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    knowledgeState = {};
                    resetGame();
                }
            }

            // í†µê³„ ì—…ë°ì´íŠ¸
            function updateStats() {
                const knownCount = Object.values(knowledgeState).filter(state => state === 'known').length;
                const unknownCount = Object.values(knowledgeState).filter(state => state === 'unknown').length;
                const totalCount = musicList.length;
                const remainingCount = totalCount - knownCount - unknownCount;
                
                // í˜„ì¬ ëª¨ë“œì˜ ì´ ë¬¸ì œ ìˆ˜ ê³„ì‚°
                const currentModeQuestions = getQuestionsForMode();
                const currentRound = currentModeQuestions.length > 0 ? Math.floor((usedQuestions.length - 1) / currentModeQuestions.length) + 1 : 1;
                const totalSolved = usedQuestions.length;
                
                totalStat.textContent = totalCount;
                knownStat.textContent = knownCount;
                unknownStat.textContent = unknownCount;
                remainingStat.textContent = remainingCount;
                
                // í˜„ì¬ ëª¨ë“œ ì§„í–‰ ìƒí™© í‘œì‹œ
                if (currentModeQuestions.length > 0) {
                    const progressInfo = document.querySelector('.progress-info');
                    if (!progressInfo) {
                        const newProgressInfo = document.createElement('div');
                        newProgressInfo.className = 'stat-item progress-info';
                        newProgressInfo.innerHTML = `
                            <div class="stat-label">í˜„ì¬ ëª¨ë“œ ì§„í–‰</div>
                            <div class="stat-value" id="progressStat">-</div>
                        `;
                        document.querySelector('.stats-grid').appendChild(newProgressInfo);
                    }
                    
                    const progressStat = document.getElementById('progressStat');
                    if (progressStat) {
                        progressStat.textContent = `${totalSolved}ë¬¸ì œ í’€ì´`;
                    }
                }
            }

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            modeButtons.forEach(btn => {
                btn.addEventListener('click', () => selectMode(btn.dataset.mode));
            });

            knowYesBtn.addEventListener('click', () => markKnowledge(true));
            knowNoBtn.addEventListener('click', () => markKnowledge(false));
            showAnswerBtn.addEventListener('click', showAnswer);
            nextBtn.addEventListener('click', nextQuestion);
            resetBtn.addEventListener('click', fullReset);

            // ì´ˆê¸°í™”
            // HTML ë¬¸ì„œê°€ ì™„ì „íˆ ë¡œë“œëœ í›„ì— ì‹¤í–‰ë˜ë„ë¡ ë³´ì¥
            updateStats();
            loadNewQuestion();
        }); // DOMContentLoaded ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë
    </script>
</body>
</html>